Алгоритм консенсуса LPoS
========================================
В PoS системе низкая стоимость создания блока поскольку не требуется проводить сложные, энергозатратные вычисления, по сути, самым сложным для майнера 
является создание цифровой подписи блока.

Proof of Stake
---------------------
Механизм принятия решения завязан на количестве токенов на счету пользователя.
Чем больше у пользователя токенов, тем выше вероятность, что он сможет создать блок.
Право создания блока разыгрвается случайным образом, но так, чтобы за статистически значимый промежуток, пропорция созанных пользователем блоков соответствовала количеству токенов

В консенсусе Proof of Stake (доказательство доли) право выпуска блока псевдослучайным образом, поскольку зная предыдущего майнера и балансы всех пользователей в системе можно вычислить нвого майнера.
Для того чтобы это осуществить необходимо вычислить генерирующую подпись, как sha256 hash от генерирующей подписи этого блока и публичного ключа аккаунта. Первые 8 байт полученного хеша будут хитом.
таким образом мы можем посчитать примерное время генерации блока для аккаунта i, как

.. math::
        T_i = T_{min} + C_1 \log (1 - C_2 \frac{\log \frac{X_n}{X_{max}}}{b_i A_n})


где b\ :sub:`i` \ - это стейк (доля баланса учасника от общего баланса системы), A\ :sub:`n` \ baseTarget, X\ :sub:`n` \ генерирующая подпись или хит учатсника i, T\ :sub:`min` \ = 5 константа, 
определяющая временной интервал между блоками,C\ :sub:`1` \ = 70 константа, корректирующая форму распределения интервала между блоками, C\ :sub:`2` \ = 5E17 константа для регулировки значения baseTarget.
Из приведенной формулы лекго убедиться, что вероятность выбора участника зависит от доли активов участника в системе: больше доля — выше шанс. Минимальное количество токенов на балансе для майнинга — 1000 VST.
BaseTarget в свою очередь вычисляется как:

.. math::
    (S > R_{max} \rightarrow T_b = T_{p} + max(1, \frac{T_p}{100})) \wedge 
    (S < R_{min} \land \land T_{b} > 1 \rightarrow T_b = T_p - max(1, \frac{T_p}{100}))



где R \ :sub:`max` \= 90 - максимальное уменьшение таргета, когда время генерации блока в сети превышает 60 секунд, R\ :sub:`min` \ = 30 -минимальное увеличение таргета, когда время генерации блока в сети меньше 60 секунд,
S - среднее время генерации, как минимум для трех последних блоков, T\ :sub:`p` \ - предыдущее значение baseTarget and T\ :sub:`b` \ - вычисленное значение baseTarget.

Глубокое описание технических особенностей и доработок классического PoS алгоритма вы можете найти в этой `статье <https://forum.wavesplatform.com/uploads/default/original/2X/7/7397a4cb5fa77d659a7b7ecc9188dd0a4fe0decc.pdf/>`_.

Преимущества перед Proof of Work
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Этот факт позволяет PoS системам снизить требования к аппаратному обеспечению участников системы, привлекая больше потенциальных пользователей
(либо, не требуя закупки дорогостоящего оборудования для приватных систем).
А также отпадает необходимость дополнительных эмиссий, которые в PoW системах используются для вознаграждения майнеров, за нахождение нового блока. В PoS-системах майнер
(или просто создатель нового блока, поскольку непосредственно тяжелых вычислений (майнинга) он не производит) получает вознаграждение в виде комиссий за транзакции, которые попали в его блок.

Безопасность
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Так же PoS консенсус имеет аналогичные гарантии безопасности. Атаку 51%, то разница заключается в том, что майнер в PoW системе 
не является заинтересованным лицом - его временное обладание 51% мощности сети, не дает никаких гарантий для самой сети - он может вести блокчейн полностью в своих интересах и, 
например повысить комиссию за транзакции. В то время как в PoS системе такому участнику необходимо приобрести 51% токенов - что является очень финансово затратным мероприятием 
(так как во время начала скупки еще и цены серьезно возрастут из-за возросшего спроса при неизменном предложении).
В итоге инвестору будет невыгодно пытаться разрушить систему, в которую он вложил столько средств.

Leased Proof of Stake
----------------------
Для большего удобства пользователя, который либо обладает маленьким стейком и вероятность его выбора в качестве майнера следующего блока очень мала, либо по при выборе его в качестве майнера, может быть оффлайн
и пропустить свою очередь создать блок, протоколом предусмотрена возможность передать свой баланс в лизинг другим участникам, и получать процент, с полученных ими комиссий за транзакции.
Поскольку вероятность выбора участника увеличивается с долей его монет в системе, то отдавая в лизинг свои токены - можно увеличить вероятность выбора этого майнера, за что потом вы будете получать процент комиссии с транзакций,
которых этот майнер поместил в свои блоки. Лизинг является полностью безопасной операцией, поскольку ваши токены фактически не покидают ваш кошелек, а вы только передаете свое право майнинга другому участнику сети.
